---
title: "Mini Project 3: Accessible Camping!"
author: "Cassie Naranjo and Amelia Stapleton"
date: "4/12/2019"
output: 
  html_document:
    code_folding: hide
---
+1 for having at least 500 words and no more than 800 words

```{r,include = FALSE, echo = FALSE}
library(tidyverse)
library(sf)
library(macleish)
library(leaflet)
```

Have you ever wanted to go the Macleish Station and enjoy a campsite with friends or on your own, but don't actually want to hike to the campsite? Or perhaps, you are physically unable to hike to one of the already resurrected campsites? Well, we have a solution for you! We have used spatial data of the Macleish Field Station to discover two new campsites locations that are easily accessible from the main parking lot or Conway Road. Both of these proposed campsites follow the guidelines of less than .5 miles way from the parking lot and 200 feet away from a stream or other body of water, more than 500 feet away from a challenge course or research area, relatively flat, within the boundraries of Macleish, and positioned in vegetation that is unlike the two campsites that already exist, the group campsite and the remote campsite.

```{r, message = FALSE, warning = FALSE, results = 'hide'}
#Determing the location of the Parking Lot 

parking <- data.frame(lat = 42.448013, lon = -72.68066)
parking_plot <- leaflet() %>%
  addTiles() %>%
  addMarkers(lng = ~lon, lat = ~lat, data = parking,
             popup = "Parking Lot")
parking_plot
```

```{r, message = FALSE, warning = FALSE, results = 'hide'}
#Determing the Location of the Group Campsite

group_campsite <- data.frame(lat = 42.450976, lon = -72.678154)
group_plot <- leaflet() %>%
  addTiles() %>%
  addMarkers(lng = ~lon, lat = ~lat, data = group_campsite,
             popup = "Group Campsite")
group_plot
```

```{r, message = FALSE, warning = FALSE, results = 'hide'}
#Determining the Location of the Remote Campsite

remote_campsite <- data.frame(lat = 42.458549, lon = -72.679581)
remote_plot <- leaflet() %>%
  addTiles() %>%
  addMarkers(lng = ~lon, lat = ~lat, data = remote_campsite,
             popup = "Remote Campsite")
remote_plot
```

```{r, message = FALSE, warning = FALSE, results = 'hide'}
#Combining the 3 sites (parking, remote campsite, and group campsite) into one map

base_plot <- leaflet() %>%
  addTiles() %>%
  addMarkers(lng = ~lon, lat = ~lat, data = group_campsite,
             popup = "Group Campsite") %>%
  addMarkers(lng = ~lon, lat = ~lat, data = remote_campsite,
             popup = "Remote Campsite") %>%
  addMarkers(lng = ~lon, lat = ~lat, data = parking,
             popup = "Parking Lot") 
  base_plot
```

```{r, message = FALSE, warning = FALSE, results = 'hide'}
#Determing the Macleisch Station Boundary
boundary <- macleish_layers %>% 
pluck("boundary")

base_plot %>%
addPolygons(data = boundary, color = "black")
```

```{r, message = FALSE, warning = FALSE, results = 'hide'}
#Determing the Locations of the Streams and Wetlands

leaflet() %>%
addTiles %>% 
addPolygons(data = pluck(macleish_layers, "wetlands"), color = ~SHAPE_AREA, popup = ~IT_VALDESC) %>%
addPolylines(data = pluck(macleish_layers, "streams"), weight = 3, color = "orange")
```

```{r}
#Adding a buffer the streams to ensure proposed campsites are within 200 feet of a body of water

proj4_aea <- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs"

buffer_streams <- macleish_layers %>%
  pluck("streams") %>%
  st_transform(proj4_aea) %>%
  st_buffer(dist = 60.96) %>%
  st_transform(4326)

leaflet() %>%
  addTiles %>% 
  addPolygons(data = buffer_streams)
```

```{r, message = FALSE, warning = FALSE, results = 'hide'}
#Looking at the different forest types within Macleish to ensure our new campsites are in a different vegetation zone than previous campsites

#Naming the forest color palette
forest_pal <- colorFactor("plasma", 
macleish_layers %>%
pluck("forests") %>%
pull(VegType_21)
)
```

```{r, message = FALSE, warning = FALSE, results = 'hide'}
#Adding the color palette and forest types onto leaflet map

leaflet() %>%
addTiles %>% 
addPolygons(data = pluck(macleish_layers, "forests"), color = ~forest_pal(VegType_21), fillOpacity = 0.8, weight = 0.1, popup = ~Sheet1__Na)
```

```{r,message = FALSE, warning = FALSE, results = 'hide'}
#Viewing the Contours of Macleish to assess potential campsite locations and ensure they are housed on relatively flat land

#Using the 3m contour dataset because it is more detailed compared to the 30 ft dataset

leaflet() %>%
addTiles() %>%
addPolylines(data = pluck(macleish_layers, "contours_3m"), weight = 1, color = "red") 
```

```{r, message = FALSE, warning = FALSE, results = 'hide'}
#Determing the location of the challenge courses to allow for 500 feet between any of these locations and our proposed campsites

challenge_area <- leaflet() %>%
addTiles %>% 
addCircles(data = pluck(macleish_layers, "challenge_courses"))

buffer_challenge <- macleish_layers %>%
  pluck("challenge_courses") %>%
  st_transform(proj4_aea) %>%
  st_buffer(dist = 152.4) %>%
  st_transform(4326)

leaflet() %>%
  addTiles %>% 
  addPolygons(data = buffer_challenge, weight = 1, color = "red")
```

```{r, message = FALSE, warning = FALSE,results = 'hide'}
#Determing the location of the research areas to allow for 500 feet between any of these locations and our proposed campsites

leaflet() %>%
  addTiles() %>%
  addPolygons(data = pluck(macleish_layers, "research"), color = "yellow")

buffer_research <- macleish_layers %>%
  pluck("research") %>%
  st_transform(proj4_aea) %>%
  st_buffer(dist = 152.4) %>%
  st_transform(4326)

leaflet() %>%
  addTiles %>% 
  addPolygons(data = buffer_research, weight = 1, color = "yellow")

```

```{r, message = FALSE, warning = FALSE}
#The choosen coordinates for new campsites

BlackBirch_campsite <- data.frame(lat = 42.44788, lon = -72.680015)
RedOak_campsite <- data.frame(lat = 42.45425, lon = -72.68540)
```
 
```{r, message = FALSE, warning = FALSE}
#Code for making cool icons

campicon <- makeIcon(
  iconUrl = "http://icons.iconarchive.com/icons/thegirltyler/brand-camp/256/Camp-Fire-Stories-icon.png",
  iconWidth = 25, iconHeight = 30)
```
The final map with our proposed campsites and all the criteria that went into determining these locations:
```{r, message = FALSE, warning = FALSE}
leaflet() %>%
addTiles() %>%
addMarkers(lng = ~lon, lat = ~lat, data = group_campsite,popup = "Group Campsite") %>%
addMarkers(lng = ~lon, lat = ~lat, data = remote_campsite,popup = "Remote Campsite") %>%
addMarkers(lng = ~lon, lat = ~lat, data = parking,popup = "Parking Lot") %>%
addMarkers(lng = ~lon, lat = ~lat, data = BlackBirch_campsite,
             popup = "New Campsite #1", icon = campicon) %>%
addMarkers(lng = ~lon, lat = ~lat, data = RedOak_campsite, popup = "New Campsite #2", icon = campicon) %>%
addCircles(data = parking, radius = 804, color = "grey") %>%
addPolygons(data = boundary, color = "black") %>%
addPolygons(data = pluck(macleish_layers, "wetlands"), color = ~SHAPE_AREA, popup = ~IT_VALDESC) %>%
addPolylines(data = pluck(macleish_layers, "streams"), weight = 7, color = "navy") %>%
addPolylines(data = pluck(macleish_layers, "contours_3m"), weight = 1, color = "red") %>%
addPolygons(data = pluck(macleish_layers, "research"), color = "yellow") %>%
addCircles(data = pluck(macleish_layers, "challenge_courses"), fillOpacity = 1) %>%
addPolygons(data = pluck(macleish_layers, "forests"), color = ~forest_pal(VegType_21), fillOpacity = 0.5, weight = 0.1, popup = ~Sheet1__Na) %>%
addPolylines(data = pluck(macleish_layers, "trails"), weight = 3, color = "black")
```
The final map showing the buffers for streams (less than 200 feet from) and research areas/challenge courses (500 feet away):
```{r}
leaflet() %>%
  addTiles() %>%
  addMarkers(lng = ~lon, lat = ~lat, data = BlackBirch_campsite,
             popup = "New Campsite #1", icon = campicon) %>%
addMarkers(lng = ~lon, lat = ~lat, data = RedOak_campsite, popup = "New Campsite #2", icon = campicon) %>%
  addPolygons(data = buffer_streams) %>%
  addPolygons(data = buffer_challenge, weight = 1, color = "red") %>%
  addPolygons(data = buffer_research, weight = 1, color = "yellow")
```

Discussion:
+1 for including relevant external information in your analysis
what will it cost?
+1 for reporting at least one actionable recommendation (what should Smith DO with your findings?)
how long will it take?
are there any concerns about environmental impact?
do you see any major roadblocks?

Footnotes:
Github repository link
Issues post

Notes for Write-Up:
Stream doesn't always flow 
close to a road 
other one is full of roses that creates umbrella of rose bushes 