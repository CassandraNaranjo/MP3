---
title: "Mini Project 3: Accessible Camping!"
author: "Cassie Naranjo and Amelia Stapleton"
date: "4/12/2019"
output: 
  html_document:
    code_folding: hide
---
+1 for having at least 500 words and no more than 800 words

Problem Statement: 

```{r,include = FALSE, echo = FALSE}
library(tidyverse)
library(sf)
library(macleish)
library(leaflet)
```

Introduction:

Determing the location of the Parking Lot: 
```{r, message = FALSE, warning = FALSE}
parking <- data.frame(lat = 42.448013, lon = -72.68066)
parking_plot <- leaflet() %>%
  addTiles() %>%
  addMarkers(lng = ~lon, lat = ~lat, data = parking,
             popup = "Parking Lot")
parking_plot
```
Determing the Location of the Group Campsite:
```{r, message = FALSE, warning = FALSE}
group_campsite <- data.frame(lat = 42.450976, lon = -72.678154)
group_plot <- leaflet() %>%
  addTiles() %>%
  addMarkers(lng = ~lon, lat = ~lat, data = group_campsite,
             popup = "Group Campsite")
group_plot
```
Determining the Location of the Remote Campsite:
```{r, message = FALSE, warning = FALSE}
remote_campsite <- data.frame(lat = 42.458549, lon = -72.679581)
remote_plot <- leaflet() %>%
  addTiles() %>%
  addMarkers(lng = ~lon, lat = ~lat, data = remote_campsite,
             popup = "Remote Campsite")
remote_plot
```
Combining the 3 sites (parking, remote campsite, and group campsite) into one map:
```{r, message = FALSE, warning = FALSE}
base_plot <- leaflet() %>%
  addTiles() %>%
  addMarkers(lng = ~lon, lat = ~lat, data = group_campsite,
             popup = "Group Campsite") %>%
  addMarkers(lng = ~lon, lat = ~lat, data = remote_campsite,
             popup = "Remote Campsite") %>%
  addMarkers(lng = ~lon, lat = ~lat, data = parking,
             popup = "Parking Lot") 
  base_plot
```
Determing the Macleisch Station Boundary:
```{r, message = FALSE, warning = FALSE}
boundary <- macleish_layers %>% 
pluck("boundary")

base_plot %>%
addPolygons(data = boundary, color = "black")
```
Determing the Locations of the Streams and Wetlands:
```{r, message = FALSE, warning = FALSE}
leaflet() %>%
addTiles %>% 
addPolygons(data = pluck(macleish_layers, "wetlands"), color = ~SHAPE_AREA, popup = ~IT_VALDESC) %>%
addPolylines(data = pluck(macleish_layers, "streams"), weight = 3, color = "orange")
```
Adding a buffer the streams to ensure proposed campsites are within 200 feet of a body of water:
```{r}
buffer_streams <- macleish_layers %>%
  pluck("streams") %>%
  st_transform() %>%
  st_buffer(dist = 200)
```
Looking at the different forest types within Macleish to ensure our new campsites are in a different vegetation zone than previous campsites:
```{r, message = FALSE, warning = FALSE}
# Naming the forest color palette
forest_pal <- colorFactor("plasma", 
macleish_layers %>%
pluck("forests") %>%
pull(VegType_21)
)
```

```{r, message = FALSE, warning = FALSE}
#Adding the color palette and forest types onto leaflet map
leaflet() %>%
addTiles %>% 
addPolygons(data = pluck(macleish_layers, "forests"), color = ~forest_pal(VegType_21), fillOpacity = 0.8, weight = 0.1, popup = ~Sheet1__Na)
```
Viewing the Contours of Macleish to assess potential campsite locations and ensure they are housed on relatively flat land:
```{r,message = FALSE, warning = FALSE}
#Using the 3m contour dataset because it is more detailed compared to the 30 ft dataset

leaflet() %>%
addTiles() %>%
addPolylines(data = pluck(macleish_layers, "contours_3m"), weight = 1, color = "red") 
```
Determing the location of the challenge courses to allow for 500 feet between any of these locations and our proposed campsites:
```{r, echo = FALSE}
challenge_area <- leaflet() %>%
addTiles %>% 
addCircles(data = pluck(macleish_layers, "challenge_courses"))
```

```{r, message = FALSE, warning = FALSE}
#The choosen coordinates for new campsites

BlackBirch_campsite <- data.frame(lat = 42.44788, lon = -72.680015)
RedOak_campsite <- data.frame(lat = 42.45425, lon = -72.68540)
```
 
```{r, message = FALSE, warning = FALSE}
#Code for making cool icons

campicon <- makeIcon(
  iconUrl = "http://icons.iconarchive.com/icons/thegirltyler/brand-camp/256/Camp-Fire-Stories-icon.png",
  iconWidth = 25, iconHeight = 30)
```
The final map with our proposed campsites and all the criteria that went into determining these locations
```{r, message = FALSE, warning = FALSE}
leaflet() %>%
addTiles() %>%
addMarkers(lng = ~lon, lat = ~lat, data = group_campsite,popup = "Group Campsite") %>%
addMarkers(lng = ~lon, lat = ~lat, data = remote_campsite,popup = "Remote Campsite") %>%
addMarkers(lng = ~lon, lat = ~lat, data = parking,popup = "Parking Lot") %>%
addMarkers(lng = ~lon, lat = ~lat, data = BlackBirch_campsite,
             popup = "New Campsite #1", icon = campicon) %>%
addMarkers(lng = ~lon, lat = ~lat, data = RedOak_campsite, popup = "New Campsite #2", icon = campicon) %>%
addCircles(data = parking, radius = 804, color = "grey") %>%
addPolygons(data = boundary, color = "black") %>%
addPolygons(data = pluck(macleish_layers, "wetlands"), color = ~SHAPE_AREA, popup = ~IT_VALDESC) %>%
addPolylines(data = pluck(macleish_layers, "streams"), weight = 7, color = "navy") %>%
addPolylines(data = pluck(macleish_layers, "contours_3m"), weight = 1, color = "red") %>%
addPolygons(data = pluck(macleish_layers, "research"), color = "yellow") %>%
addCircles(data = pluck(macleish_layers, "challenge_courses"), fillOpacity = 1) %>%
addPolygons(data = pluck(macleish_layers, "forests"), color = ~forest_pal(VegType_21), fillOpacity = 0.5, weight = 0.1, popup = ~Sheet1__Na) %>%
addPolylines(data = pluck(macleish_layers, "trails"), weight = 3, color = "black")
```

Discussion:
+1 for including relevant external information in your analysis
what will it cost?
+1 for reporting at least one actionable recommendation (what should Smith DO with your findings?)
how long will it take?
are there any concerns about environmental impact?
do you see any major roadblocks?

Footnotes:
Github repository link
Issues post

Notes for Write-Up:
Stream doesn't always flow 
close to a road 
other one is full of roses that creates umbrella of rose bushes 